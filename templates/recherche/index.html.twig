{# templates/recherche/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Recherche{% endblock %}

{% block body %}
    <h1></h1>

    <div style="background-color: #ccc; height: 50px;"></div>

    <div style="margin-top: 20px;">
        <input type="text" id="searchInput" placeholder="Rechercher..." style="border-radius: 10px; padding: 10px; width: 70%;">
        <input type="date" style="border-radius: 10px; padding: 10px; margin-left: 10px;">
        <button id="searchButton" style="border-radius: 50%; padding: 10px; background-color: #333; color: #fff;">
            <span>&#128269;</span>
        </button>
    </div>

    <!-- Conteneur pour les résultats de recherche en temps réel -->
    <div id="searchResults" style="margin-top: 20px;"></div>

    <script>
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchResultsContainer = document.getElementById('searchResults');

        // Fonction pour effectuer la recherche
        function performSearch() {
            const searchQuery = searchInput.value;

            // Effectue la requête AJAX vers le point de terminaison Symfony
            fetch(`/search?term=${searchQuery}`)
                .then(response => response.json())
                .then(data => {
                    // Efface les résultats précédents
                    searchResultsContainer.innerHTML = '';

                    // Affiche les nouveaux résultats
                    data.forEach(result => {
                        const resultElement = document.createElement('div');
                        resultElement.textContent = result;
                        searchResultsContainer.appendChild(resultElement);
                    });
                })
                .catch(error => console.error('Error fetching search results:', error));
        }

        // Écoute les changements dans l'input de recherche
        searchInput.addEventListener('input', function() {
            // Si la recherche contient au moins 3 caractères
            if (searchInput.value.length >= 3) {
                // Effectue la recherche
                performSearch();
            } else {
                // Efface les résultats si la recherche est trop courte
                searchResultsContainer.innerHTML = '';
            }
        });

        // Écoute le clic sur le bouton de recherche
        searchButton.addEventListener('click', function() {
            // Effectue la recherche
            performSearch();
        });
    </script>
{% endblock %}
